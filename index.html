<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitor de Carteira BNB</title>
<style>
body { font-family: Arial, sans-serif; background: #111; color: #eee; text-align: center; padding: 20px; }
.card { background: #1a1a1a; border-radius: 10px; padding: 20px; margin: 10px auto; width: 90%; max-width: 500px; box-shadow: 0 0 10px #000; }
h1 { color: #f0b90b; }
table { width: 100%; border-collapse: collapse; margin-top: 15px; }
td, th { padding: 6px; border-bottom: 1px solid #333; font-size: 14px; }
th { color: #f0b90b; }
</style>
</head>
<body>

<h1>Carteira Monitorada</h1>
<div class="card">
  <h2>Endereço</h2>
  <div id="address">0x4A0153E289b475Fd8693f415C00813dC77b50E64</div>

  <h2>Saldo</h2>
  <p id="bnb">Carregando...</p>
  <p id="usd"></p>
  <p id="brl"></p>

  <h2>Variação BNB 24h</h2>
  <p id="bnbChange">Carregando...</p>
</div>

<div class="card">
  <h2>Últimas Transações Recebidas</h2>
  <table id="txsTable">
    <tr><th>Hash</th><th>De</th><th>Valor (BNB)</th></tr>
  </table>
</div>

<script>
const ADDRESS = "0x4A0153E289b475Fd8693f415C00813dC77b50E64";
const API_KEY = "ESBZ6MIBSP39YA2PPTJDBYSG7N2IHH7QJA"; // gere em https://bscscan.com/myapikey

async function getBalance() {
  const res = await fetch(`https://api.bscscan.com/api/v2/address/${ADDRESS}/balance?apikey=${API_KEY}`);
  const data = await res.json();
  return data.result ? Number(data.result.balance) / 1e18 : 0;
}

async function getTransactions() {
  const res = await fetch(`https://api.bscscan.com/api/v2/address/${ADDRESS}/transactions?sort=desc&apikey=${API_KEY}`);
  const data = await res.json();
  return Array.isArray(data.result) ? data.result.filter(tx => tx.to?.toLowerCase() === ADDRESS.toLowerCase()) : [];
}

async function getBNBPrice() {
  const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd,brl&include_24hr_change=true");
  const data = await res.json();
  return data.binancecoin;
}

async function loadData() {
  try {
    const [balance, txs, price] = await Promise.all([
      getBalance(),
      getTransactions(),
      getBNBPrice()
    ]);

    document.getElementById("bnb").textContent = `${balance.toFixed(6)} BNB`;
    document.getElementById("usd").textContent = `≈ ${(balance * price.usd).toFixed(2)} USD`;
    document.getElementById("brl").textContent = `≈ R$ ${(balance * price.brl).toFixed(2)} BRL`;

    const change = price.usd_24h_change.toFixed(2);
    document.getElementById("bnbChange").textContent =
      (change >= 0 ? "▲ " : "▼ ") + change + "%";

    const table = document.getElementById("txsTable");
    txs.slice(0, 10).forEach(tx => {
      const row = table.insertRow();
      row.innerHTML = `
        <td><a href="https://bscscan.com/tx/${tx.hash}" target="_blank">${tx.hash.slice(0, 10)}...</a></td>
        <td>${tx.from.slice(0, 10)}...</td>
        <td>${(tx.value / 1e18).toFixed(4)}</td>
      `;
    });
  } catch (err) {
    console.error("Erro geral:", err);
  }
}

loadData();
</script>
</body>
</html>
